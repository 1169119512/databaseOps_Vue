# 数据库连接配置文件说明

## 📝 配置文件格式

### JSON 格式（推荐）

文件名：`database_connections_template.json`

```json
[
  {
    "name": "连接名称",
    "baseURL": "http://localhost:8080",
    "tableName": "table-name",
    "description": "连接描述（可选）"
  }
]
```

### 字段说明

| 字段 | 类型 | 必填 | 说明 | 示例 |
|------|------|------|------|------|
| `name` | String | ✅ 是 | 连接名称 | "供应商档案" |
| `baseURL` | String | ✅ 是 | 后端API地址 | "http://localhost:8080" |
| `tableName` | String | ✅ 是 | 模块名/表名 | "supplier-archive" |
| `description` | String | ❌ 否 | 连接描述 | "供应商档案管理子系统" |

## 🎯 使用步骤

### 步骤1：下载模板文件

1. 进入"连接管理"页面
2. 点击"批量操作" → "下载配置模板"
3. 保存文件：`database_connections_template.json`

### 步骤2：编辑配置文件

用文本编辑器打开文件，根据需要修改：

**示例：添加自定义连接**

```json
[
  {
    "name": "我的数据库1",
    "baseURL": "http://192.168.1.100:8080",
    "tableName": "my-table-1",
    "description": "这是我的第一个数据库"
  },
  {
    "name": "我的数据库2",
    "baseURL": "http://192.168.1.100:8080",
    "tableName": "my-table-2",
    "description": "这是我的第二个数据库"
  }
]
```

**示例：修改后端地址**

```json
[
  {
    "name": "供应商档案",
    "baseURL": "https://api.mycompany.com",  // 修改为实际地址
    "tableName": "supplier-archive",
    "description": "供应商档案管理子系统"
  }
]
```

### 步骤3：导入配置文件

1. 进入"连接管理"页面
2. 点击"批量操作" → "从文件导入配置"
3. 选择编辑好的 JSON 文件
4. 确认导入信息
5. 点击"导入"按钮

### 步骤4：验证导入结果

- 查看连接列表，确认配置已导入
- 点击"测试"按钮验证连接
- 点击"进入管理"开始使用

## 📋 完整配置示例

### 13个子系统完整配置

```json
[
  {
    "name": "供应商档案",
    "baseURL": "http://localhost:8080",
    "tableName": "supplier-archive",
    "description": "供应商档案管理子系统"
  },
  {
    "name": "发票池表头",
    "baseURL": "http://localhost:8080",
    "tableName": "invoice-header",
    "description": "发票池表头管理子系统"
  },
  {
    "name": "发票池明细",
    "baseURL": "http://localhost:8080",
    "tableName": "invoice-detail",
    "description": "发票池明细管理子系统"
  },
  {
    "name": "费用映射",
    "baseURL": "http://localhost:8080",
    "tableName": "expense-mapping",
    "description": "费用映射配置子系统"
  },
  {
    "name": "客户分部配置",
    "baseURL": "http://localhost:8080",
    "tableName": "customer-branch-config",
    "description": "客户分部配置子系统"
  },
  {
    "name": "法人主体配置",
    "baseURL": "http://localhost:8080",
    "tableName": "legal-entity-config",
    "description": "法人主体配置子系统"
  },
  {
    "name": "用户管理",
    "baseURL": "http://localhost:8080",
    "tableName": "user-management",
    "description": "用户管理子系统"
  },
  {
    "name": "税率配置",
    "baseURL": "http://localhost:8080",
    "tableName": "tax-calculation-config",
    "description": "税率配置子系统"
  },
  {
    "name": "管理员配置",
    "baseURL": "http://localhost:8080",
    "tableName": "admin-config",
    "description": "管理员配置子系统"
  },
  {
    "name": "红字信息表主表",
    "baseURL": "http://localhost:8080",
    "tableName": "red-letter-header",
    "description": "红字信息表主表子系统"
  },
  {
    "name": "红字信息明细表",
    "baseURL": "http://localhost:8080",
    "tableName": "red-letter-detail",
    "description": "红字信息明细表子系统"
  },
  {
    "name": "角色管理",
    "baseURL": "http://localhost:8080",
    "tableName": "role-management",
    "description": "角色管理子系统"
  },
  {
    "name": "项目管理",
    "baseURL": "http://localhost:8080",
    "tableName": "project-management",
    "description": "项目管理子系统"
  }
]
```

## ⚠️ 注意事项

### 配置文件要求

1. **文件格式**
   - ✅ 必须是有效的 JSON 格式
   - ✅ 使用 UTF-8 编码
   - ✅ 文件扩展名为 `.json`

2. **数组格式**
   - ✅ 最外层必须是数组 `[ ]`
   - ✅ 每个配置项是对象 `{ }`
   - ✅ 多个配置项用逗号分隔

3. **字段验证**
   - ✅ `name`、`baseURL`、`tableName` 为必填项
   - ✅ `description` 为可选项
   - ❌ 不能有额外的未知字段

### 常见错误

#### 错误1：JSON 格式错误

```json
// ❌ 错误：缺少逗号
[
  {
    "name": "连接1"
    "baseURL": "http://localhost:8080"  // 缺少逗号
  }
]

// ✅ 正确：有逗号
[
  {
    "name": "连接1",
    "baseURL": "http://localhost:8080"
  }
]
```

#### 错误2：缺少必填字段

```json
// ❌ 错误：缺少 tableName
[
  {
    "name": "连接1",
    "baseURL": "http://localhost:8080"
  }
]

// ✅ 正确：包含所有必填字段
[
  {
    "name": "连接1",
    "baseURL": "http://localhost:8080",
    "tableName": "my-table"
  }
]
```

#### 错误3：不是数组格式

```json
// ❌ 错误：是对象不是数组
{
  "name": "连接1",
  "baseURL": "http://localhost:8080",
  "tableName": "my-table"
}

// ✅ 正确：数组格式
[
  {
    "name": "连接1",
    "baseURL": "http://localhost:8080",
    "tableName": "my-table"
  }
]
```

## 🔧 高级用法

### 批量修改后端地址

使用查找替换功能批量修改：

1. 打开配置文件
2. 查找：`"baseURL": "http://localhost:8080"`
3. 替换为：`"baseURL": "https://api.production.com"`
4. 全部替换
5. 保存并重新导入

### 合并多个配置文件

```json
// 文件1：开发环境配置
[
  {
    "name": "开发-供应商档案",
    "baseURL": "http://localhost:8080",
    "tableName": "supplier-archive"
  }
]

// 文件2：生产环境配置
[
  {
    "name": "生产-供应商档案",
    "baseURL": "https://api.prod.com",
    "tableName": "supplier-archive"
  }
]

// 合并后：包含两个环境的配置
[
  {
    "name": "开发-供应商档案",
    "baseURL": "http://localhost:8080",
    "tableName": "supplier-archive"
  },
  {
    "name": "生产-供应商档案",
    "baseURL": "https://api.prod.com",
    "tableName": "supplier-archive"
  }
]
```

## 💡 最佳实践

1. **备份现有配置**
   - 导入新配置前，先"导出当前配置"备份

2. **分环境管理**
   - 开发环境：`dev_connections.json`
   - 测试环境：`test_connections.json`
   - 生产环境：`prod_connections.json`

3. **版本控制**
   - 将配置文件加入 Git 版本控制
   - 记录每次修改的原因

4. **命名规范**
   - 使用清晰的连接名称
   - 建议格式：`环境-模块名`
   - 例如：`生产-供应商档案`

## 📚 相关文档

- [导入说明.md](./导入说明.md) - 详细的导入操作指南
- [README.md](./README.md) - 项目整体说明文档

## ❓ 常见问题

**Q: 文件导入是覆盖还是合并？**
A: 合并模式，不会删除现有连接

**Q: 可以导入多次吗？**
A: 可以，每次导入会生成新的ID

**Q: 如何完全替换配置？**
A: 先"清空所有连接"，再导入新配置

**Q: 支持其他文件格式吗？**
A: 目前仅支持 JSON 格式

**Q: 导入失败怎么办？**
A: 检查JSON格式是否正确，使用在线JSON验证工具验证

